{"version":3,"sources":["app.js","services/moment.js","services/calendarhelper.js","filters/truncateEventTitle.js","directives/mwlcalendaryear.js","directives/mwlcalendarweek.js","directives/mwlcalendarmonth.js","directives/mwlcalendarday.js","directives/mwlcalendar.js"],"names":[],"mappings":"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","file":"angular-bootstrap-calendar.min.js","sourcesContent":["'use strict';\n\n/**\n * @ngdoc overview\n * @name angularBootstrapCalendarApp\n * @description\n * # angularBootstrapCalendarApp\n *\n * Main module of the application.\n */\nangular\n  .module('mwl.calendar', [\n    'ui.bootstrap'\n  ]);\n","'use strict';\n\n/**\n * @ngdoc service\n * @name angularBootstrapCalendarApp.moment\n * @description\n * # moment\n * Constant in the angularBootstrapCalendarApp.\n */\nangular.module('mwl.calendar')\n  .constant('moment', window.moment);\n","'use strict';\n\n/**\n * @ngdoc service\n * @name angularBootstrapCalendarApp.calendarHelper\n * @description\n * # calendarHelper\n * Service in the angularBootstrapCalendarApp.\n */\nangular.module('mwl.calendar')\n  .service('calendarHelper', [\"$filter\", \"moment\", function calendarHelper($filter, moment) {\n\n    var self = this;\n\n    function isISOWeekBasedOnLocale() {\n      return moment().startOf('week').day() === 1;\n    }\n\n    function isISOWeek(userValue) {\n      //If a manual override has been set in the directive, use that\n      if (angular.isDefined(userValue)) return userValue;\n      //Otherwise fallback to the locale\n      return isISOWeekBasedOnLocale();\n    }\n\n    this.getMonthNames = function(short) {\n\n      var format = short ? 'MMM' : 'MMMM';\n\n      var months = [];\n      for (var i = 0; i <= 11; i++) {\n        months.push($filter('date')(new Date(2014, i), format));\n      }\n\n      return months;\n\n    };\n\n    this.getWeekDayNames = function(short, useISOWeek) {\n\n      var format = short ? 'EEE' : 'EEEE';\n\n      var weekdays = [];\n      var startDay = isISOWeek(useISOWeek) ? 22 : 21;\n      for (var i = 0; i <= 6; i++) {\n        weekdays.push($filter('date')(new Date(2014, 8, startDay + i), format));\n      }\n\n      return weekdays;\n\n    };\n\n    this.eventIsInPeriod = function(eventStart, eventEnd, periodStart, periodEnd) {\n\n      return (\n          moment(eventStart).isAfter(moment(periodStart)) &&\n          moment(eventStart).isBefore(moment(periodEnd))\n        ) || (\n          moment(eventEnd).isAfter(moment(periodStart)) &&\n          moment(eventEnd).isBefore(moment(periodEnd))\n        ) || (\n          moment(eventStart).isBefore(moment(periodStart)) &&\n          moment(eventEnd).isAfter(moment(periodEnd))\n        ) || (\n          moment(eventStart).isSame(moment(periodStart))\n        ) || (\n          moment(eventEnd).isSame(moment(periodEnd))\n      );\n\n    };\n\n    this.getYearView = function(events, currentDay) {\n\n      var grid = [];\n      var months = self.getMonthNames();\n\n      for (var i = 0; i < 3; i++) {\n        var row = [];\n        for (var j = 0; j < 4; j++) {\n          var monthIndex = 12 - months.length;\n          var startPeriod = new Date(moment(currentDay).format('YYYY'), monthIndex, 1);\n          var endPeriod = moment(startPeriod).add(1, 'month').subtract(1, 'second').toDate();\n\n          row.push({\n            label: months.shift(),\n            monthIndex: monthIndex,\n            isToday: moment(startPeriod).startOf('month').isSame(moment().startOf('month')),\n            events: events.filter(function(event) {\n              return self.eventIsInPeriod(event.starts_at, event.ends_at, startPeriod, endPeriod);\n            })\n          });\n        }\n        grid.push(row);\n      }\n\n      return grid;\n\n    };\n\n    this.getMonthView = function(events, currentDay, useISOWeek) {\n\n      var dateOffset = isISOWeek(useISOWeek) ? 1 : 0;\n\n      function getWeekDayIndex() {\n        var day = startOfMonth.day() - dateOffset;\n        if (day < 0) day = 6;\n        return day;\n      }\n\n      var startOfMonth = moment(currentDay).startOf('month');\n      var numberOfDaysInMonth = moment(currentDay).endOf('month').date();\n\n      var grid = [];\n      var buildRow = new Array(7);\n      var eventsWithIds = events.map(function(event, index) {\n        event.$id = index;\n        return event;\n      });\n\n      for (var i = 1; i <= numberOfDaysInMonth; i++) {\n\n        if (i == 1) {\n          var weekdayIndex = getWeekDayIndex(startOfMonth);\n          var prefillMonth = startOfMonth.clone();\n          while (weekdayIndex > 0) {\n            weekdayIndex--;\n            prefillMonth = prefillMonth.subtract(1, 'day');\n            buildRow[weekdayIndex] = {\n              label: prefillMonth.date(),\n              date: prefillMonth.clone(),\n              inMonth: false,\n              events: []\n            };\n          }\n        }\n\n        buildRow[getWeekDayIndex(startOfMonth)] = {\n          label: startOfMonth.date(),\n          inMonth: true,\n          isToday: moment().startOf('day').isSame(startOfMonth),\n          date: startOfMonth.clone(),\n          events: eventsWithIds.filter(function(event) {\n            return self.eventIsInPeriod(event.starts_at, event.ends_at, startOfMonth.clone().startOf('day'), startOfMonth.clone().endOf('day'));\n          })\n        };\n\n        if (i == numberOfDaysInMonth) {\n          var weekdayIndex = getWeekDayIndex(startOfMonth);\n          var postfillMonth = startOfMonth.clone();\n          while (weekdayIndex < 6) {\n            weekdayIndex++;\n            postfillMonth = postfillMonth.add(1, 'day');\n            buildRow[weekdayIndex] = {\n              label: postfillMonth.date(),\n              date: postfillMonth.clone(),\n              inMonth: false,\n              events: []\n            };\n          }\n        }\n\n        if (getWeekDayIndex(startOfMonth) === 6 || i == numberOfDaysInMonth) {\n          grid.push(buildRow);\n          buildRow = new Array(7);\n        }\n\n        startOfMonth = startOfMonth.add(1, 'day');\n\n      }\n\n      return grid;\n\n    };\n\n    this.getWeekView = function(events, currentDay, useISOWeek) {\n\n      var dateOffset = isISOWeek(useISOWeek) ? 1 : 0;\n      var columns = new Array(7);\n      var weekDays = self.getWeekDayNames(false, useISOWeek);\n      var currentWeekDayIndex = currentDay.getDay();\n      var beginningOfWeek, endOfWeek;\n\n      for (var i = currentWeekDayIndex; i >= 0; i--) {\n        var date = moment(currentDay).subtract(currentWeekDayIndex - i, 'days').add(dateOffset, 'day').toDate();\n        columns[i] = {\n          weekDay: weekDays[i],\n          day: $filter('date')(date, 'd'),\n          date: $filter('date')(date, 'd MMM'),\n          isToday: moment(date).startOf('day').isSame(moment().startOf('day'))\n        };\n        if (i == 0) {\n          beginningOfWeek = date;\n        } else if (i == 6) {\n          endOfWeek = date;\n        }\n      }\n\n      for (var i = currentWeekDayIndex + 1; i < 7; i++) {\n        var date = moment(currentDay).add(i - currentWeekDayIndex, 'days').add(dateOffset, 'day').toDate();\n        columns[i] = {\n          weekDay: weekDays[i],\n          day: $filter('date')(date, 'd'),\n          date: $filter('date')(date, 'd MMM'),\n          isToday: moment(date).startOf('day').isSame(moment().startOf('day'))\n        };\n        if (i == 0) {\n          beginningOfWeek = date;\n        } else if (i == 6) {\n          endOfWeek = date;\n        }\n      }\n\n      endOfWeek = moment(endOfWeek).endOf('day').toDate();\n      beginningOfWeek = moment(beginningOfWeek).startOf('day').toDate();\n\n      var eventsSorted = events.filter(function(event) {\n        return self.eventIsInPeriod(event.starts_at, event.ends_at, beginningOfWeek, endOfWeek);\n      }).map(function(event) {\n        var span = moment(event.ends_at).startOf('day').diff(moment(event.starts_at).startOf('day'), 'days') + 1;\n        if (span >= 7) {\n          span = 7;\n          if (moment(event.ends_at).startOf('day').diff(moment(endOfWeek).startOf('day'), 'days') < 0) {\n            span += moment(event.ends_at).startOf('day').diff(moment(endOfWeek).startOf('day'), 'days') + dateOffset;\n          }\n        }\n\n        var offset = moment(event.starts_at).startOf('day').diff(moment(beginningOfWeek).startOf('day'), 'days');\n        if (offset < 0) offset = 0;\n        if (offset > 6) offset = 6;\n\n        if (span - offset > 0) {\n          span -= offset;\n        }\n\n        event.daySpan = span;\n        event.dayOffset = offset;\n        return event;\n      });\n\n      return {columns: columns, events: eventsSorted};\n\n    };\n\n    this.getDayView = function(events, currentDay) {\n\n      var calendarStart = moment(currentDay).startOf('day').add(6, 'hours');\n      var calendarEnd = moment(currentDay).startOf('day').add(22, 'hours');\n      var calendarHeight = 16 * 60;\n      var buckets = [];\n\n      return events.filter(function(event) {\n        return self.eventIsInPeriod(event.starts_at, event.ends_at, moment(currentDay).startOf('day').toDate(), moment(currentDay).endOf('day').toDate());\n      }).map(function(event) {\n        if (moment(event.starts_at).isBefore(calendarStart)) {\n          event.top = 0;\n        } else {\n          event.top = moment(event.starts_at).startOf('minute').diff(calendarStart.startOf('minute'), 'minutes') - 2;\n        }\n\n        if (moment(event.ends_at).isAfter(calendarEnd)) {\n          event.height = calendarHeight - event.top;\n        } else {\n          var diffStart = event.starts_at;\n          if (moment(event.starts_at).isBefore(calendarStart)) {\n            diffStart = calendarStart.toDate();\n          }\n          event.height = moment(event.ends_at).diff(diffStart, 'minutes');\n        }\n\n        if (event.top - event.height > calendarHeight) {\n          event.height = 0;\n        }\n\n        event.left = 0;\n\n        return event;\n      }).filter(function(event) {\n        return event.height > 0;\n      }).map(function(event) {\n\n        var cannotFitInABucket = true;\n        buckets.forEach(function(bucket, bucketIndex) {\n          var canFitInThisBucket = true;\n\n          bucket.forEach(function(bucketItem) {\n            if (self.eventIsInPeriod(event.starts_at, event.ends_at, bucketItem.starts_at, bucketItem.ends_at) || self.eventIsInPeriod(bucketItem.starts_at, bucketItem.ends_at, event.starts_at, event.ends_at)) {\n              canFitInThisBucket = false;\n            }\n          });\n\n          if (canFitInThisBucket && cannotFitInABucket) {\n            cannotFitInABucket = false;\n            event.left = bucketIndex * 150;\n            buckets[bucketIndex].push(event);\n          }\n\n        });\n\n        if (cannotFitInABucket) {\n          event.left = buckets.length * 150;\n          buckets.push([event]);\n        }\n\n        return event;\n\n      });\n\n    };\n\n    this.toggleEventBreakdown = function(view, rowIndex, cellIndex) {\n\n      var openEvents = [];\n\n      if (view[rowIndex][cellIndex].events.length > 0) {\n\n        var isCellOpened = view[rowIndex][cellIndex].isOpened;\n\n        view = view.map(function(row) {\n          row.isOpened = false;\n          return row.map(function(cell) {\n            cell.isOpened = false;\n            return cell;\n          });\n        });\n\n        view[rowIndex][cellIndex].isOpened = !isCellOpened;\n        view[rowIndex].isOpened = !isCellOpened;\n        openEvents = view[rowIndex][cellIndex].events;\n      }\n\n      return {view: view, openEvents: openEvents};\n\n    };\n\n  }]);\n","'use strict';\n\n\nangular.module('mwl.calendar')\n  .filter('truncateEventTitle', function() {\n\n    return function(string, length, boxHeight) {\n      if (!string) return '';\n\n      //Only truncate if if actually needs truncating\n      if (string.length >= length && string.length / 20 > boxHeight / 30) {\n        return string.substr(0, length) + '...';\n      } else {\n        return string;\n      }\n    };\n\n  });\n","'use strict';\n\n/**\n * @ngdoc directive\n * @name angularBootstrapCalendarApp.directive:mwlCalendarYear\n * @description\n * # mwlCalendarYear\n */\nangular.module('mwl.calendar')\n  .directive('mwlCalendarYear', [\"$sce\", \"$timeout\", \"calendarHelper\", \"moment\", function($sce, $timeout, calendarHelper, moment) {\n    return {\n      templateUrl: 'templates/year.html',\n      restrict: 'EA',\n      require: '^mwlCalendar',\n      scope: {\n        events: '=calendarEvents',\n        currentDay: '=calendarCurrentDay',\n        eventClick: '=calendarEventClick',\n        eventEditClick: '=calendarEditEventClick',\n        eventDeleteClick: '=calendarDeleteEventClick',\n        editEventHtml: '=calendarEditEventHtml',\n        deleteEventHtml: '=calendarDeleteEventHtml',\n        autoOpen: '=calendarAutoOpen'\n      },\n      link: function postLink(scope, element, attrs, calendarCtrl) {\n\n        var firstRun = false;\n\n        scope.$sce = $sce;\n\n        calendarCtrl.titleFunctions.year = function(currentDay) {\n          return moment(currentDay).format('YYYY');\n        };\n\n        function updateView() {\n          scope.view = calendarHelper.getYearView(scope.events, scope.currentDay);\n\n          //Auto open the calendar to the current day if set\n          if (scope.autoOpen && !firstRun) {\n            scope.view.forEach(function(row, rowIndex) {\n              row.forEach(function(year, cellIndex) {\n                if (year.label == moment(scope.currentDay).format('MMMM')) {\n                  scope.monthClicked(rowIndex, cellIndex);\n                  $timeout(function() {\n                    firstRun = false;\n                  });\n                }\n              });\n            });\n          }\n        }\n\n        scope.$watch('currentDay', updateView);\n        scope.$watch('events', updateView, true);\n\n        scope.monthClicked = function(yearIndex, monthIndex) {\n\n          var handler = calendarHelper.toggleEventBreakdown(scope.view, yearIndex, monthIndex);\n          scope.view = handler.view;\n          scope.openEvents = handler.openEvents;\n\n        };\n\n        scope.drillDown = function(month) {\n          calendarCtrl.changeView('month', moment(scope.currentDay).clone().month(month).toDate());\n        };\n\n      }\n    };\n  }]);\n","'use strict';\n\n/**\n * @ngdoc directive\n * @name angularBootstrapCalendarApp.directive:mwlCalendarWeek\n * @description\n * # mwlCalendarWeek\n */\nangular.module('mwl.calendar')\n  .directive('mwlCalendarWeek', [\"moment\", \"calendarHelper\", function(moment, calendarHelper) {\n    return {\n      templateUrl: 'templates/week.html',\n      restrict: 'EA',\n      require: '^mwlCalendar',\n      scope: {\n        events: '=calendarEvents',\n        currentDay: '=calendarCurrentDay',\n        eventClick: '=calendarEventClick',\n        useIsoWeek: '=calendarUseIsoWeek'\n      },\n      link: function postLink(scope, element, attrs, calendarCtrl) {\n\n        calendarCtrl.titleFunctions.week = function(currentDay) {\n          return 'Week ' + moment(currentDay).week() + ' of ' + moment(currentDay).format('YYYY');\n        };\n\n        function updateView() {\n          scope.view = calendarHelper.getWeekView(scope.events, scope.currentDay, scope.useIsoWeek);\n        }\n\n        scope.drillDown = function(day) {\n          calendarCtrl.changeView('day', moment(scope.currentDay).clone().date(day).toDate());\n        };\n\n        scope.$watch('currentDay', updateView);\n        scope.$watch('events', updateView, true);\n\n      }\n    };\n  }]);\n","'use strict';\n\n/**\n * @ngdoc directive\n * @name angularBootstrapCalendarApp.directive:mwlCalendarMonth\n * @description\n * # mwlCalendarMonth\n */\nangular.module('mwl.calendar')\n  .directive('mwlCalendarMonth', [\"$sce\", \"$timeout\", \"calendarHelper\", function ($sce, $timeout, calendarHelper) {\n    return {\n      templateUrl: 'templates/month.html',\n      restrict: 'EA',\n      require: '^mwlCalendar',\n      scope: {\n        events: '=calendarEvents',\n        currentDay: '=calendarCurrentDay',\n        eventClick: '=calendarEventClick',\n        eventEditClick: '=calendarEditEventClick',\n        eventDeleteClick: '=calendarDeleteEventClick',\n        editEventHtml: '=calendarEditEventHtml',\n        deleteEventHtml: '=calendarDeleteEventHtml',\n        autoOpen: '=calendarAutoOpen',\n        useIsoWeek: '=calendarUseIsoWeek'\n      },\n      link: function postLink(scope, element, attrs, calendarCtrl) {\n\n        var firstRun = false;\n\n        scope.$sce = $sce;\n\n        calendarCtrl.titleFunctions.month = function(currentDay) {\n          return moment(currentDay).format('MMMM YYYY');\n        };\n\n        function updateView() {\n          scope.view = calendarHelper.getMonthView(scope.events, scope.currentDay, scope.useIsoWeek);\n\n          //Auto open the calendar to the current day if set\n          if (scope.autoOpen && !firstRun) {\n            scope.view.forEach(function(week, rowIndex) {\n              week.forEach(function(day, cellIndex) {\n                if (day.inMonth && moment(scope.currentDay).startOf('day').isSame(day.date.startOf('day'))) {\n                  scope.dayClicked(rowIndex, cellIndex);\n                  $timeout(function() {\n                    firstRun = false;\n                  });\n                }\n              });\n            });\n          }\n\n        }\n\n        scope.$watch('currentDay', updateView);\n        scope.$watch('events', updateView, true);\n\n        scope.weekDays = calendarHelper.getWeekDayNames(false, scope.useIsoWeek);\n\n        scope.dayClicked = function(rowIndex, cellIndex) {\n\n          var handler = calendarHelper.toggleEventBreakdown(scope.view, rowIndex, cellIndex);\n          scope.view = handler.view;\n          scope.openEvents = handler.openEvents;\n\n        };\n\n        scope.drillDown = function(day) {\n          calendarCtrl.changeView('day', moment(scope.currentDay).clone().date(day).toDate());\n        };\n\n        scope.highlightEvent = function(event, shouldAddClass) {\n\n          scope.view = scope.view.map(function(week) {\n\n            week.isOpened = false;\n\n            return week.map(function(day) {\n\n              delete day.highlightClass;\n              day.isOpened = false;\n\n              if (shouldAddClass) {\n                var dayContainsEvent = day.events.filter(function(e) {\n                  return e.$id == event.$id;\n                }).length > 0;\n\n                if (dayContainsEvent) {\n                  day.highlightClass = 'day-highlight dh-event-' + event.type;\n                }\n              }\n\n              return day;\n\n            });\n\n          });\n\n        };\n\n      }\n    };\n  }]);\n","'use strict';\n\n/**\n * @ngdoc directive\n * @name angularBootstrapCalendarApp.directive:mwlCalendarDay\n * @description\n * # mwlCalendarDay\n */\nangular.module('mwl.calendar')\n  .directive('mwlCalendarDay', [\"calendarHelper\", function(calendarHelper) {\n    return {\n      templateUrl: 'templates/day.html',\n      restrict: 'EA',\n      require: '^mwlCalendar',\n      scope: {\n        events: '=calendarEvents',\n        currentDay: '=calendarCurrentDay',\n        eventClick: '=calendarEventClick'\n      },\n      link: function postLink(scope, element, attrs, calendarCtrl) {\n\n        calendarCtrl.titleFunctions.day = function(currentDay) {\n          return moment(currentDay).format('dddd DD MMMM, YYYY');\n        };\n\n        function updateView() {\n          scope.view = calendarHelper.getDayView(scope.events, scope.currentDay);\n        }\n\n        scope.$watch('currentDay', updateView);\n        scope.$watch('events', updateView, true);\n\n      }\n    };\n  }]);\n","'use strict';\n\n/**\n * @ngdoc directive\n * @name angularBootstrapCalendarApp.directive:mwlCalendar\n * @description\n * # mwlCalendar\n */\nangular.module('mwl.calendar')\n  .directive('mwlCalendar', [\"moment\", function (moment) {\n    return {\n      templateUrl: 'templates/main.html',\n      restrict: 'EA',\n      scope: {\n        events: '=calendarEvents',\n        view: '=calendarView',\n        currentDay: '=calendarCurrentDay',\n        control: '=calendarControl',\n        eventClick: '&calendarEventClick',\n        eventEditClick: '&calendarEditEventClick',\n        eventDeleteClick: '&calendarDeleteEventClick',\n        editEventHtml: '=calendarEditEventHtml',\n        deleteEventHtml: '=calendarDeleteEventHtml',\n        autoOpen: '=calendarAutoOpen',\n        useIsoWeek: '=calendarUseIsoWeek'\n      },\n      controller: [\"$scope\", function($scope) {\n\n        var self = this;\n\n        this.titleFunctions = {};\n\n        this.changeView = function(view, newDay) {\n          $scope.view = view;\n          $scope.currentDay = newDay;\n        };\n\n        $scope.control = $scope.control || {};\n\n        $scope.control.prev = function() {\n          $scope.currentDay = moment($scope.currentDay).subtract(1, $scope.view).toDate();\n        };\n\n        $scope.control.next = function() {\n          $scope.currentDay = moment($scope.currentDay).add(1, $scope.view).toDate();\n        };\n\n        $scope.control.getTitle = function() {\n          if (!self.titleFunctions[$scope.view]) return '';\n          return self.titleFunctions[$scope.view]($scope.currentDay);\n        };\n\n      }]\n    };\n  }]);\n"],"sourceRoot":"/source/"}